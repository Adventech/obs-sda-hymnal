import{c as i,a as u,F as d,f,i as w,o as a,b as y,w as p,T as m,t as _}from"./index-Bkj_fG1t.js";import{_ as g}from"./_plugin-vue_export-helper-DlAUqK2U.js";const c="obs-sda-hymnal",x=new BroadcastChannel("obs-sda-hymnal"),I={data(){return{queue:[],currentIterator:0,show:!1}},methods:{processQueue:function(e){try{this.queue=JSON.parse(e).queue}catch{}},chunkArray:function(e,r){const t=[];for(let s=0;s<e.length;s+=r)t.push(e.slice(s,s+r));return t},handleKeyPress(e){e.key==="ArrowLeft"?this.prev():e.key==="ArrowRight"?this.next():e.key==="Space"&&this.showHide()},showHide:function(){this.show=!this.show},prev:function(){this.currentIterator>=0&&this.show&&this.currentIterator--},next:function(){this.currentIterator<this.lowerThirds.length-1&&this.show&&this.currentIterator++}},created(){let e=localStorage.getItem(c);this.processQueue(e);let r=this;window.addEventListener("storage",function(t){if(t.key===c)try{r.processQueue(t.newValue)}catch{}}),x.onmessage=t=>{t.data.action==="clear"&&(this.currentIterator=0),t.data.action==="next"&&this.next(),t.data.action==="prev"&&this.prev(),t.data.action==="showHide"&&this.showHide()}},mounted(){window.addEventListener("keydown",this.handleKeyPress)},beforeUnmount(){window.removeEventListener("keydown",this.handleKeyPress)},computed:{lowerThirds:function(){let e=[];if(!this.queue.length)return this.currentIterator=0,e;for(let r of this.queue){e.push([`${r.index} - ${r.title}`,""]);for(let t of r.lyrics)e=e.concat(this.chunkArray(t.lines,2));e.push([""])}return this.currentIterator>e.length-1&&(this.currentIterator=e.length-1),e}}},k={key:0,class:"transition ease-in-out delay-150 duration-300 text-white text-8xl h-screen flex flex-col justify-end items-center"},T={class:"w-full flex items-center flex-col p-10"},L={class:"transition-opacity"};function v(e,r,t,s,n,o){return n.show&&o.lowerThirds.length&&o.lowerThirds[n.currentIterator]&&o.lowerThirds[n.currentIterator].length?(a(),i("div",k,[u("div",T,[(a(!0),i(d,null,f(o.lowerThirds[n.currentIterator],(h,l)=>(a(),i("div",L,[y(m,{name:"fade"},{default:p(()=>[(a(),i("div",{class:"block lower-third transition-opacity",key:`${n.currentIterator}_${l}`},_(h),1))]),_:2},1024)]))),256))])])):w("",!0)}const b=g(I,[["render",v]]);export{b as default};
